<!DOCTYPE html>
<html>
 <head>
  <title>WEBNEWS by Applh.com</title>
   <script type="text/javascript" charset="utf-8" src="cordova-2.5.0.js"></script>
   <script type="text/javascript" charset="utf-8">
var WN={};
WN.init_phonegap=function() {
   window.requestFileSystem(LocalFileSystem.PERSISTENT, 0, WN.init_FS_ready, fail);
};
WN.init_FS_ready=function (fileSystem) {
   fileSystem.root.getFile("webnews.txt", {create: true, exclusive: false}, WN.init_FS_prepare, fail);
   
   WN.file_cache=fileSystem.root.fullPath+"/webnews.txt";
   WN.server_download();
   
   WN.file_readlist();
   
}
WN.init_FS_prepare=function (fileEntry) {
   fileEntry.createWriter(WN.init_FS_start, WN.init_FS_fail);
}
WN.init_FS_start=function (writer) {
   writer.write("http://Applh.com");
}
WN.init_FS_fail=function (error) {
   console.log(error.code);
}

WN.server_download=function() {
   // !! Assumes filePath is a valid path on the device
   filePath=WN.file_cache;
   var fileTransfer = new FileTransfer();
   var uri = encodeURI("http://applh.com/robots.txt");

   fileTransfer.download(
    uri,
    filePath,
    function(entry) {
        console.log("download complete: " + entry.fullPath);
    },
    function(error) {
        console.log("download error source " + error.source);
        console.log("download error target " + error.target);
        console.log("upload error code" + error.code);
    }
   );
};

WN.file_readlist=function() {
   // Get a directory reader
   var directoryReader = fileSystem.root.createReader();

   // Get a list of all the entries in the directory
   directoryReader.readEntries(WN.file_readlist_success, WN.file_readlist_fail);
};

WN.file_readlist_success=function (entries) {
    var i;
    for (i=0; i<entries.length; i++) {
        document.writeln('<h2>'+entries[i].name+'</h2>');
    }
};

WN.file_readlist_fail=function (error) {
    alert("Failed to list directory contents: " + error.code);
};


// Wait for Cordova to load
document.addEventListener("deviceready", WN.init_phonegap, false);

   </script>
 </head>
 <body>
 <h1>Web News</h1>
 </body>
</html>
